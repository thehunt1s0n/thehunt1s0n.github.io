---
title: Pelican Write up
date: 2023-12-1 12:00:00 -500
categories: [writeup]
tags: [proving grounds]
# TAGS should always be lowercase
---

# Welcome to my Pelican Write-up 

## Recon

Let's start with some enumeration.



<div style="background-color: #1e2124; padding: 10px;">
<span style="color:red">$ sudo nmap -sSVC -A -Pn -T4 -oA nmap 192.168.164.98</span>
</div>


    Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-16 09:20 EST
    Nmap scan report for 192.168.164.98 (192.168.164.98)
    Host is up (0.13s latency).
    Not shown: 993 closed tcp ports (reset)
    PORT     STATE SERVICE     VERSION
    22/tcp   open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
    | ssh-hostkey: 
    |   2048 a8:e1:60:68:be:f5:8e:70:70:54:b4:27:ee:9a:7e:7f (RSA)
    |   256 bb:99:9a:45:3f:35:0b:b3:49:e6:cf:11:49:87:8d:94 (ECDSA)
    |_  256 f2:eb:fc:45:d7:e9:80:77:66:a3:93:53:de:00:57:9c (ED25519)
    139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
    445/tcp  open  etbios-p  Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)
    631/tcp  open  ipp         CUPS 2.2
    |_http-server-header: CUPS/2.2 IPP/2.1
    | http-methods: 
    |_  Potentially risky methods: PUT
    |_http-title: Forbidden - CUPS v2.2.
    2222/tcp open  ssh         OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
    | ssh-hostkey: 
    |   2048 a8:e1:60:68:be:f5:8e:70:70:54:b4:27:ee:9a:7e:7f (RSA)
    |   256 bb:99:9a:45:3f:35:0b:b3:49:e6:cf:11:49:87:8d:94 (ECDSA)
    |_  256 f2:eb:fc:45:d7:e9:80:77:66:a3:93:53:de:00:57:9c (ED25519)
    8080/tcp open  http        Jetty 1.0
    |_http-title: Error 404 Not Found
    |_http-server-header: Jetty(1.0)

    8081/tcp open  http        nginx 1.14.2
    |_http-title: Did not follow redirect to http://192.168.164.98:8080/exhibitor/v1/ui/index.html
    |_http-server-header: nginx/1.14.2



<div style="background-color: #1e2124; padding: 10px;">
<span style="color:red">$ sudo nmap -p- --min-rate=5000 192.168.164.98</span>
</div>
<br>


![image 1](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image1.png)



<div style="background-color: #1e2124; padding: 10px;">
<span style="color:red">$ sudo nmap -sU --min-rate=10000 192.168.164.98</span>
</div>
<br>

![image 2](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image2.png)

## Initial Foothold

This machine's ssh and samba versions are not vulnerable. Also there is nothing to be found on port 8080.

Let's visit the web app running on port 8081.

http://192.168.164.98:8081


![image 3](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image3.png)


We get redirected to http://192.168.164.98:8080/exhibitor/v1/ui/index.html

I searched in google for the zookeeper exploit then I found this:

[https://www.exploit-db.com/exploits/48654](https://www.exploit-db.com/exploits/48654)



![image 8](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image8.png)

To exploit the vulnerability we need to follow these steps:

Config:

![image 4](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image4.png)


Enable Editing

![image 5](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image5.png)

Edit the script

![image 6](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image6.png)


![image 7](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image7.png)


### <span style="color:green">2nd Method



![image 9](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image9.png)





## Privilege Escalation

Using linpeas I found:

![image 10](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image10.png)


<div style="background-color: #1e2124; padding: 10px;">
charles@pelican:~$<span style="color:red"> sudo -l</span>
</div>
<br>


![image 11](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image11.png)

It seems like we can run /usr/bin/gcore without a password as charles.

![gif 1](https://raw.githubusercontent.com/thehunt1s0n/media/main/heheboy.gif)

><span style="color:green; font-style:italic; font-family: Calibri, sans-serif; font-size: larger">It can be used to generate core dumps of running processes. Such files often contains sensitive information such as open files content, cryptographic keys, passwords, etc. This command produces a binary file named core.$PID, that is then often filtered with strings to narrow down relevant information.</span>


<div style="background-color: #1e2124; padding: 10px;">
charles@pelican:~$<span style="color:red"> ps -ef | grep ssh</span>
</div>
<br>

![image 12](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image13.png)

<div style="background-color: #1e2124; padding: 10px;">
charles@pelican:~$<span style="color:red"> sudo gcore 526</span>
</div>
<br>

<div style="background-color: #1e2124; padding: 10px;">
charles@pelican:~$<span style="color:red"> strings core.526</span>
</div>
<br>

I got lots of output but nothing interesting. Then I tried with password instead of ssh.


<div style="background-color: #1e2124; padding: 10px;">
charles@pelican:/opt/zookeeper$<span style="color:red"> ps -ef | grep pass</span>
</div>
<br>

![image 13](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image13.png)


<div style="background-color: #1e2124; padding: 10px;">
charles@pelican:/opt/zookeeper$<span style="color:red"> sudo gcore 493</span>
</div>
<br>

<div style="background-color: #1e2124; padding: 10px;">
charles@pelican:~$<span style="color:red"> strings core.493</span>
</div>
<br>


![image 15](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image15.png)

Interesting! We found a password.

![image 14](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image14.png)


<div style="background-color: #1e2124; padding: 10px;">
>harles@pelican:~$<span style="color:red"> su</span>
</div>
<br>

ClogKingpinInning731


<div style="background-color: #1e2124; padding: 10px;">
root@pelican:/home/charles#<span style="color:red"> cat /root/proof.txt && whoami && hostname && ip a</span>
</div>
<br>


![image 16](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image16.png)



<div style="background-color: #1e2124; padding: 10px;">
root@pelican:/home/charles#<span style="color:red"> cat /home/charles/local.txt && whoami && hostname && ip a</span>
</div>
<br>



![image 17](https://raw.githubusercontent.com/thehunt1s0n/media/main/Pelican/image17.png)


pwned :)



[link](https://drive.google.com/drive/folders/1cb6DcmwJpbyv2X6pi44xN4QwIw1vMlYx)


https://drive.google.com/drive/folders/1cb6DcmwJpbyv2X6pi44xN4QwIw1vMlYx

[LAB](https://drive.google.com/drive/folders/1cb6DcmwJpbyv2X6pi44xN4QwIw1vMlYx)

[cours](https://drive.google.com/drive/folders/1cb6DcmwJpbyv2X6pi44xN4QwIw1vMlYx)

[2nd QCM](https://testbook.com/objective-questions/mcq-on-owasp-top-10-vulnerabilities--5eea6a0d39140f30f369e30b)

https://testbook.com/objective-questions/mcq-on-owasp-top-10-vulnerabilities--5eea6a0d39140f30f369e30b

---------------------------------------------------------

> What is the attack technique used to exploit websites by altering backend database queries through inputting manipulated queries?

-SQL Injection

>What happens when an application takes user-inputted data and sends it to a web browser without proper validation and escaping?

-Cross Site Scripting


>What flaw arises from session tokens having poor randomness across a range of values?

-Session Hijacking

>An attack technique that forces a user's session credential or session ID to an explicit value.

-Session Fixation

>What threat arises from not flagging HTTP cookies with tokens as secure?

-Session Hijacking

>Which attack can execute scripts in the user's browser and is capable of hijacking user sessions, defacing websites, or redirecting the user to malicious sites?

-Cross Site Scripting

>What flaw can lead to exposure of resources or functionality to unintended actors?

-Improper Authentication

>Which threat can be prevented by having unique usernames generated with a high degree of entropy?

-Authentication bypass

>hat threat are you vulnerable to if you do not validate the authorization of the user for direct references to restricted resources?

-Insecure Direct Objects References

>Role-Based Access control helps prevent this OWASP Top 10 weakness.

-Failure to restrict URL Access


>What is the type of flaw that occurs when untrusted user-entered data is sent to the interpreter as part of a query or command?

-Injection


>For every link or form which invokes state-changing functions with an unpredictable token for each user what attack can be prevented?


-Cross Site Request Forgery

>For a connection that changes from HTTP to HTTPS, what flaw arises if you do not change the session identifier?


-Session Replay

>The attack exploits the trust that a site has in a user's browser.

-Cross Site Request Forgery


>For an indirect reference, what happens if there's no list of limited values authorized for a user in the direct reference?


-Access to sensetive data possible

>We can allow client-side scripts to execute in the browsers for needed operations.

-True

>Session related vulnerabilities.

-Session Fixation

-Session Hijacking

>What is phishing?

-Email Scam


>What is a cookie?

-A file that makes it easier to access a Web site and browse.

>You receive an e-mail from Desjardins saying that you have won a contest. What should you do?

-Contact Caisse to confirm the information.

>An IP Address is the Internet equivalent of:

-your mailing address

>Statistics show that many companies connected to the Internet are not sufficiently secure. Why not?


-Many companies do not have a written security policy in place. 

-Many companies have insufficient protection between the Internet and company networks. 

-Many companies have insufficient information about the traffic over the company networks. 


>The use of proper security techniques can:

-Minimize the threat of attackers 

-Prevent most hackers from accessing your system.


>Network permissions should be established so that users can accomplish their tasks, but cannot access any system resources that are not necessary so that:


-Only the resources authorized for that user will be at risk.


>The characteristics of an effective security system are that the system is:

-Highly secure, easy to use, flexible, and scalable 

-One that provides comprehensive alarming and reporting



